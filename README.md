# Анализ пространственно-временной динамики R-фактора RUSLE

## Назначение

Репозиторий содержит инструменты анализа и визуализации годового R-фактора уравнения RUSLE, рассчитанного по откалиброванным данным IMERG V07 (v5_year_anchor) за период **2001–2024 гг.**

Расчёт R-фактора выполнен по методике RUSLE2 (event-based, формула энергии `e = 0.29·(1 − 0.72·exp(−0.05·i))`) с использованием маски фазового состояния осадков (жидкие/твёрдые). Исходный код расчёта: `r_factor_rusle2.py`.

## Исходные данные

| Параметр | Значение |
|----------|----------|
| Продукт | IMERG V07, калиброванный (v5_year_anchor) |
| Период | 2001–2024 (24 года) |
| Разрешение | 0.1° (~10 км) |
| CRS | EPSG:4326 |
| Размер сетки | 23 × 48 пикселей |
| Валидных пикселей | 818 из 1104 (0 = NoData) |
| Единицы | МДж·мм/(га·ч·год) |

## Предварительные результаты

- **Средне-доменный R**: 159 МДж·мм/(га·ч·год) (диапазон 48–324 по годам)
- **CV межгодовой**: 41%
- **Тренд**: −0.96 ед./год (статистическая значимость уточняется)
- **Экстремальные годы**: 2001 (максимум, R̄ = 324), 2009 (минимум, R̄ = 48)

## Структура

```
rfactor-analysis/
├── config.py                     # Конфигурация: пути, параметры, визуализация
├── scripts/
│   ├── 01_compute_stats.py       # Сводная статистика → CSV
│   ├── 02_mean_map.py            # Карта среднемноголетнего R (GeoTIFF + PNG)
│   ├── 03_annual_maps.py         # Small-multiples карты по годам
│   ├── 04_timeseries.py          # Временной ряд + тренд + аномалии
│   ├── 05_cv_trend_maps.py       # Карты CV и попиксельного тренда
│   └── 06_summary_table.py       # Таблицы Markdown + LaTeX
└── output/
    ├── tables/                   # CSV, Markdown, LaTeX
    ├── maps/                     # Карты (GeoTIFF + PNG)
    └── plots/                    # Графики
```

## Быстрый старт

### Подготовка

Данные R-фактора находятся в каталоге с кириллическими путями. GDAL/rasterio требует обходного решения:

```powershell
subst Z: "D:\Cache\Yandex.Disk\РНФ25-28\Осадки\rfactor_imerg\annual"
```

### Запуск

```bash
python scripts/01_compute_stats.py
python scripts/02_mean_map.py
python scripts/03_annual_maps.py
python scripts/04_timeseries.py
python scripts/05_cv_trend_maps.py
python scripts/06_summary_table.py
```

## Зависимости

```
numpy
rasterio
matplotlib
scipy
```

Опционально: `pymannkendall` (тест Манна-Кендалла), `cartopy` (подложка карт).
